{% extends "/layouts/layout.html" %}

{% block title %}{{ session.user.name }}{% endblock %}

{% block header %}{{ session.user.name }}{% endblock %}
{% block description %}personal page{% endblock %}

{% block main %}
  <main class='login_main'>

    <figure class='login_figure'>
      pic <img>
    </figure>

    <div class='login_container'>

      {% if form %}
        <form action="/user/{{ session.user.name }}" method='POST' class='login_form'>
          {{ form.csrf_token }}
          {{ form.old_password(placeholder="Old password", autofocus=True, pattern=pass_pattern, class='login_input') }}
          {{ form.new_password(placeholder="New password", pattern=pass_pattern, class='login_input') }}
          {{ form.confirmation(placeholder="Repeat password", pattern=pass_pattern, class='login_input') }}
          {{ form.submit(class='login_submit') }}
        </form>
      {% endif %}

      <ul class='login_list'>
        {% if form %}
          <li><h6>Help</h6></li>
          <li>&nbsp;&nbsp;from {{ pass_min }} to {{ pass_max }} unicode symbols, no spaces</li>
        {% endif %}

        {% if form %}
          {% for error in form.old_password.errors %}
            <li>{{ error }}</li>
          {% endfor %}
          {% for error in form.new_password.errors %}
            <li>{{ error }}</li>
          {% endfor %}
          {% for error in form.confirmation.errors %}
            <li>{{ error }}</li>
          {% endfor %}
        {% endif %}

        {% for message in get_flashed_messages() %}
          <li>{{ message }}</li>
        {% endfor %}
      </ul>

    </div>

  </main>
{% endblock %}

{% block footer %}
  {% include "/layouts/footer.html" %}
{% endblock %}
